<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Valet Ops Live — Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="stylesheet" href="style.css?v=20260110a" />
  <style>
    body { display: flex; flex-direction: column; min-height: 100vh; }
    .login-stage { flex: 1; }
    .site-footer {
      text-align: center;
      font-size: 12px;
      color: rgba(255,255,255,0.65);
      padding: 24px 0 16px;
    }
    .site-footer a { color: rgba(255,255,255,0.65); text-decoration: none; }
    .site-footer a:hover { color: rgba(255,255,255,0.85); }
  </style>

  <!-- Supabase v1 global -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1.35.7/dist/umd/supabase.min.js"></script>

  <!-- Auth gate + login wiring -->
  <script type="module">
    /*
      V0.912 LOGIN RULES
      - If NOT logged in → show login form
      - If logged in → redirect immediately to allowed screen
      - Do NOT wire login form if redirect happens
    */

    // Cache-bust to avoid GitHub Pages stale auth.js
    import { requireAuth, wireLoginForm } from "./auth.js?v=20260110a";

    document.addEventListener("DOMContentLoaded", async () => {
      const auth = await requireAuth({ page: "login" });

      // Only wire the form if we stayed on the login page
      if (auth?.ok) {
        wireLoginForm();
      }
    });
  </script>
</head>

<body class="public-login login-v4">
  <div class="login-hero" aria-hidden="true"></div>

  <main class="login-stage" role="main">
    <div class="login-logo-large">
      <img src="assets/optima-logo-new.jpg" alt="Optima Dealer Services" class="login-logo-large__img" />
    </div>
    <section class="login-card" aria-label="Secure sign in">
      <div class="login-card__brand-row">
        <span class="login-card__brand-text">OPTIMA DEALER SERVICES</span>
      </div>
      <hr class="login-card__divider" />
      <div class="login-card__title">Secure sign in</div>

      <form id="login-form" class="login-card__form">
        <div class="login-field">
          <label for="login-email">Email</label>
          <input id="login-email" class="input-text" type="email" autocomplete="username" required />
        </div>

        <div class="login-field">
          <label for="login-password">Password</label>
          <input id="login-password" class="input-text" type="password" autocomplete="current-password" required />
        </div>

        <div class="login-actions">
          <button class="btn btn-primary" type="submit">Sign in</button>
        </div>

        <div id="login-error" class="login-error"></div>

        <div class="login-foot">Use your dealership-issued credentials.</div>
      </form>
    </section>
  </main>
  <footer class="site-footer">
    <div>Powered by Daniel V Corona — Independent Software Platform</div>
    <div><a href="/privacy/">Privacy</a> | <a href="/terms/">Terms</a> | <a href="/contact/">Contact</a></div>
  </footer>
</body>

</html>